<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SavR - Add Expense</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="monthControls">
    <button id="prevMonthBtn" type="button" aria-label="Previous day">‚óÄ</button>
    <button id="dayCounterBtn" type="button" aria-label="Day counter" disabled>Day 1</button>
    <button id="nextMonthBtn" type="button" aria-label="Next day">‚ñ∂</button>

    <button id="hardResetBtn" type="button" aria-label="Hard reset everything">
      Hard reset
    </button>
  </div>

  <div class="header-row">
    <div class="title-block">
      <h1 class="app-title">
        <img src="images/dragon.jpg" alt="dragon" class="dragon-icon">
        SavR
        <img src="images/dragon.jpg" alt="dragon right" class="dragon-icon dragon-right">
      </h1>
      <h3>how the fuck am i poor again? where the fuck is my money going? help pls...</h3>
    </div>

    <button id="profileBtn" class="profile-btn" aria-label="Profile">
      <img src="images/blank-avatar.png" class="profile-icon" alt="">
    </button>
  </div>

  <!-- Summary row: Savings & Allowance vs XP, Streak, Level -->
  <section class="summary-grid" aria-label="Savings and stats overview">
    <div class="summary-column summary-left">
      <!-- Header row -->
      <div class="summary-item summary-heading">Savings:</div>
      <!-- Total allowance -->
      <div class="summary-item" id="allowanceDisplay">Allowance: 0.00</div>
      <!-- Savings -->
      <div class="summary-item" id="savingsInfo">Saved: 0.00</div>
      <!-- Weekly / Daily toggle -->
      <div class="summary-item">
        <div id="allowanceModeToggle" class="allowance-toggle">
          <button id="allowWeeklyBtn" type="button" class="active">Weekly</button>
          <button id="allowDailyBtn" type="button">Daily</button>
        </div>
      </div>
    </div>

    <div class="summary-column summary-right" aria-label="XP and streak stats">
      <div class="summary-item" id="scoreTotal">üìà XP: 0</div>
      <div class="summary-item" id="streakDisplay">üî• Streak: 0 days</div>
      <div class="summary-item" id="levelDisplay">üõ°Ô∏è Level: Bronze</div>
    </div>
  </section>

  <!-- Hidden remaining placeholder so JS can still update it without showing on screen -->
  <div id="allowanceRemaining" style="display:none;">Remaining: 0.00</div>

  <!-- Main table -->
  <div class="table-container" id="tableContainer">
    <h3>Submitted Expenses</h3>
    <div class="table-wrap">
      <table id="submittedExpenses" aria-label="Submitted expenses">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Amount</th>
            <th scope="col">Category</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <!-- Left & right rails -->
      <div id="leftRail" aria-hidden="true"></div>
      <div id="deleteRail" aria-hidden="true"></div>
    </div>

    <button id="clearAllBtn" type="button">Clear All</button>
    
  </div>
  
  <!-- Leaderboard Modal -->
  <div
    id="leaderboardModalOverlay"
    class="modal-overlay"
    role="dialog"
    aria-modal="true"
  >
    <div class="modal-card leaderboard-modal">
      <button class="modal-close-x" type="button" aria-label="Close">&times;</button>

      <h3>Leaderboard</h3>

      <div class="leaderboard-toggle">
        <button
          id="leaderboardToggleXp"
          type="button"
          class="leaderboard-toggle-btn active"
        >
          XP
        </button>
        <button
          id="leaderboardToggleStreak"
          type="button"
          class="leaderboard-toggle-btn"
        >
          Streak
        </button>
      </div>

      <table class="leaderboard-table">
        <thead>
          <tr>
            <th>Pos</th>
            <th>Name</th>
            <th>Level</th>
            <th>XP</th>
            <th>Streak</th>
          </tr>
        </thead>
        <tbody id="leaderboardTableBody"></tbody>
      </table>
    </div>
  </div>

  <!-- Streak warning modal -->
  <div
    id="streakWarningOverlay"
    class="modal-overlay"
    role="dialog"
    aria-modal="true"
    aria-labelledby="streakWarningTitle"
  >
    <div class="modal-card">
      <button class="modal-close-x" type="button" aria-label="Close">√ó</button>
      <h3 id="streakWarningTitle">Heads up! Your streak is at risk</h3>
      <p>If you move to the next day without adding anything, your streak will end.</p>

      <div class="modal-actions">
        <button id="streakWarningBackBtn" class="primary-btn" type="button">
          Back
        </button>
        <button id="streakWarningAddBtn" class="primary-btn" type="button">
          Add expense
        </button>
        <button id="streakWarningNoSpendBtn" class="primary-btn" type="button">
          No spending today
        </button>
        <button id="streakWarningContinueBtn" class="primary-btn" type="button">
          Continue
        </button>
      </div>
    </div>
  </div>

  <!-- Add Type Modal -->
  <div
    id="addTypeModalOverlay"
    class="modal-overlay"
    role="dialog"
    aria-modal="true"
    aria-labelledby="addTypeModalTitle"
  >
    <div class="expense-modal">
      <button class="modal-close-x" type="button" aria-label="Close modal">‚úï</button>
      <h3 id="addTypeModalTitle">What kind of expense?</h3>
      <div class="add-type-grid">
        <button id="addTypeDrinkBtn" type="button">Drink</button>
        <button id="addTypeGroceriesBtn" type="button">Groceries</button>
        <button id="addTypeBigNightBtn" type="button">Big night out?</button>
      </div>
      <hr />
      <button id="addTypeOtherBtn" type="button" class="add-type-other">
        Other
      </button>
    </div>
  </div>

  <!-- Set Goal Modal -->
  <div
    id="goalModalOverlay"
    class="modal-overlay"
    role="dialog"
    aria-modal="true"
    aria-labelledby="goalModalTitle"
  >
    <div class="modal goal-modal">
      <button class="modal-close-x" type="button" aria-label="Close">√ó</button>

      <h3 id="goalModalTitle">Set a savings goal</h3>
      <p class="goal-modal-subtitle">Pick a goal and how much you want to save.</p>

      <div class="goal-options">
        <label class="goal-option">
          <input type="radio" name="goalPreset" value="example1" />
          <span>Complete 3 No Spending Days in a 7 day period. +20XP</span>
        </label>
        <label class="goal-option">
          <input type="radio" name="goalPreset" value="example2" />
          <span>Achieve diamond level. +40XP</span>
        </label>
        <label class="goal-option">
          <input type="radio" name="goalPreset" value="example3" />
          <span>Spend an average of less than $20/day this week. +60XP</span>
        </label>
      </div>

      <div class="goal-or">‚Äî OR ‚Äî</div>

      <label class="goal-manual-label" for="goalTargetInput">
        Manually enter savings target
        <input
          id="goalTargetInput"
          type="number"
          min="0"
          step="0.01"
          placeholder="e.g. 500.00"
        />
      </label>

      <button id="goalSaveBtn" type="button" class="primary-btn goal-save-btn">
        Save goal
      </button>
    </div>
  </div>

  <!-- Add/Edit Expense Modal -->
  <div
    id="expenseModalOverlay"
    class="modal-overlay"
    role="dialog"
    aria-modal="true"
    aria-labelledby="expenseModalTitle"
  >
    <div class="expense-modal">
      <h3 id="expenseModalTitle">Add Expense</h3>

      <!-- Quick pick stage -->
      <div id="drinkQuickStage" class="quick-stage">
        <p class="quick-title">Quick pick</p>
        <div class="quick-grid">
          <button id="drinkGuinnessBtn" type="button">Guinness ‚Äî $6</button>
          <button id="drinkCoffeeBtn" type="button">Coffee ‚Äî $3.50</button>
          <button id="drinkOtherBtn" type="button">Other</button>
        </div>
        <hr />
      </div>

      <label for="modalExpenseAmount">Amount</label>
      <input
        id="modalExpenseAmount"
        type="number"
        step="0.01"
        min="0.01"
        placeholder="Enter amount"
      />

      <div id="modalCategoryWrapper">
        <label for="modalExpenseCategory">Category</label>
        <select id="modalExpenseCategory">
          <option value="Essential Living" selected>Essential Living</option>
          <option value="Social & Leisure">Social & Leisure</option>
          <option value="Personal Treats">Personal Treats</option>
          <option value="Unexpected">Unexpected</option>
        </select>
      </div>

      <div class="modal-actions">
        <button class="modal-close-x" type="button" aria-label="Close modal">‚úï</button>
        <button id="modalSubmitBtn" type="button">Submit</button>
      </div>
    </div>
  </div>

  <!-- Details Modal -->
  <div
    id="detailsModalOverlay"
    class="modal-overlay"
    role="dialog"
    aria-modal="true"
    aria-labelledby="detailsModalTitle"
  >
    <div class="expense-modal">
      <h3 id="detailsModalTitle">Expense Details</h3>
      <div id="detailsModalBody" class="details-text"></div>
      <div class="modal-actions">
        <button class="modal-close-x" type="button" aria-label="Close modal">‚úï</button>
      </div>
    </div>
  </div>

  <!-- Analytics Modal -->
  <div
    id="analyticsModalOverlay"
    class="modal-overlay"
    role="dialog"
    aria-modal="true"
    aria-labelledby="analyticsModalTitle"
  >
    <div class="expense-modal">
      <h3 id="analyticsModalTitle">Analytics</h3>

      <div id="analyticsTotals" class="details-text"></div>
      <canvas
        id="analyticsChart"
        width="200"
        height="200"
        aria-label="Analytics category chart"
      ></canvas>

      <div class="modal-actions">
        <button class="modal-close-x" type="button" aria-label="Close modal">‚úï</button>
      </div>
    </div>
  </div>

  <!-- Coming Soon Modal (Leaderboard / Rewards fallback) -->
  <div
    id="comingSoonOverlay"
    class="modal-overlay"
    role="dialog"
    aria-modal="true"
    aria-labelledby="comingSoonTitle"
  >
    <div class="expense-modal">
      <h3 id="comingSoonTitle">Coming soon</h3>
      <div id="comingSoonBody" class="details-text">
        This feature is coming soon.
      </div>
      <div class="modal-actions">
        <button class="modal-close-x" type="button" aria-label="Close modal">‚úï</button>
      </div>
    </div>
  </div>

  <!-- Rewards Modal -->
  <div
    id="rewardsModalOverlay"
    class="modal-overlay"
    role="dialog"
    aria-modal="true"
    aria-labelledby="rewardsModalTitle"
  >
    <div class="modal-card rewards-modal">
      <button
        id="rewardsCloseBtn"
        class="modal-close-x"
        type="button"
        aria-label="Close"
      >
        √ó
      </button>

      <h3 id="rewardsModalTitle">Missions & Achievements</h3>

      <div class="rewards-section">
        <h4>Current goals</h4>
        <ul id="currentGoalsList" class="rewards-list"></ul>
      </div>

      <div class="rewards-section">
        <h4>Goals completed</h4>
        <ul id="completedGoalsList" class="rewards-list"></ul>
      </div>
    </div>
  </div>

  <!-- Allowance Modal -->
  <div
    id="allowanceModalOverlay"
    class="modal-overlay"
    role="dialog"
    aria-modal="true"
    aria-labelledby="allowanceModalTitle"
  >
    <div class="expense-modal">
      <h3 id="allowanceModalTitle">Set Global Allowance</h3>
      <div id="allowanceModalStage"></div>
      <div class="modal-actions">
        <button class="modal-close-x" type="button" aria-label="Close modal">‚úï</button>
        <button id="allowanceModalBackBtn" type="button" style="display:none;">
          Back
        </button>
        <button id="allowanceModalSubmitBtn" type="button" style="display:none;">
          Submit
        </button>
      </div>
    </div>
  </div>

  <!-- Favourites Modal -->
  <div
    id="favesModalOverlay"
    class="modal-overlay"
    role="dialog"
    aria-modal="true"
    aria-labelledby="favesModalTitle"
  >
    <div class="expense-modal">
      <button class="modal-close-x" type="button" aria-label="Close modal">‚úï</button>
      <h3 id="favesModalTitle">Favourites</h3>
      <div id="favesList"></div>
    </div>
  </div>

  <!-- Favourite Name Modal -->
  <div
    id="favNameModalOverlay"
    class="modal-overlay"
    role="dialog"
    aria-modal="true"
    aria-labelledby="favNameModalTitle"
  >
    <div class="expense-modal">
      <button class="modal-close-x" type="button" aria-label="Close modal">‚úï</button>
      <h3 id="favNameModalTitle">Name your favourite</h3>
      <input
        id="favNameInput"
        type="text"
        placeholder="e.g., Friday Guinness, Payday Coffee"
      />
      <div class="modal-actions">
        <button id="favNameSaveBtn" type="button">Save</button>
      </div>
    </div>
  </div>

  <!-- Bottom-sheet quick menu for "+" -->
  <div id="quickMenuOverlay" class="bottom-sheet-overlay">
    <div class="bottom-sheet-panel">
      <button id="quickMenuAddExpense" type="button" class="sheet-item">
        Add expense
      </button>
      <button id="quickMenuFaves" type="button" class="sheet-item">
        Favourites
      </button>
      <button id="quickMenuNoSpend" type="button" class="sheet-item danger">
        No spending today
      </button>
    </div>
  </div>

  <!-- Bottom-sheet quick menu for "i" -->
  <div id="infoMenuOverlay" class="bottom-sheet-overlay">
    <div class="bottom-sheet-panel">
      <button id="infoMenuAnalytics" type="button" class="sheet-item">
        Analytics
      </button>
      <button id="infoMenuLeaderboard" type="button" class="sheet-item">
        Leaderboard
      </button>
      <button id="infoMenuMissions" type="button" class="sheet-item">
        Missions & Achievements
      </button>
    </div>
  </div>

  <button id="noSpendBtn" type="button" style="display:none;"></button>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
    window.isProfilePage = false; // on profile.html
  </script>
  <script src="script.js"></script>
  
  <!-- Streak islands visualisation -->
  <div id="streakIslands" class="streak-islands">
    <!-- Dragon that moves along the islands -->
    <img
      id="streakDragon"
      class="streak-dragon"
      src="images/blank-avatar.png"
      alt="Streak dragon"
    />

    <div class="streak-island" data-day="1">1</div>
    <div class="streak-island" data-day="2">2</div>
    <div class="streak-island" data-day="3">3</div>
    <div class="streak-island" data-day="4">4</div>
    <div class="streak-island" data-day="5">5</div>
    <div class="streak-island" data-day="6">6</div>
    <div class="streak-island" data-day="7">7</div>
  </div>

  <!-- Fixed bottom navigation bar -->
  <div id="bottomNavBar">
    <button class="nav-btn nav-blue" id="navHomeBtn">H</button>
    <button class="nav-btn nav-blue" id="navAllowBtn">A</button>

    <button class="nav-btn nav-gold nav-center-btn" id="navAddBtn">+</button>

    <button class="nav-btn nav-green" id="navGoalBtn">G</button>
    <button class="nav-btn nav-blue" id="navInfoBtn">i</button>
  </div>
</body>
</html>